<configuration>
	<include resource="logback/appender.xml" />

	<!-- from org/springframework/boot/logging/logback/base.xml -->
	<include resource="org/springframework/boot/logging/logback/defaults.xml" />

	<appender name="STDOUT" class="no.entur.logging.cloud.logback.logstash.test.CompositeConsoleAppender">
		<filter class="ch.qos.logback.classic.filter.ThresholdFilter">
			<level>${CONSOLE_LOG_THRESHOLD}</level>
		</filter>
		<humanReadablePlainEncoder class="ch.qos.logback.classic.encoder.PatternLayoutEncoder">
			<pattern>${CONSOLE_LOG_PATTERN}</pattern>
			<charset>${CONSOLE_LOG_CHARSET}</charset>
		</humanReadablePlainEncoder>
		<humanReadableJsonEncoder class="no.entur.logging.cloud.gcp.logback.logstash.StackdriverLogstashEncoder">
			<!-- remove unnecessary fields in testing -->
			<!-- note: severity and severity severity is removed in code -->
			<fieldNames>
				<version>[ignore]</version>
			</fieldNames>
			<!-- add pretty-printing and coloring for testing -->
			<jsonGeneratorDecorator class="com.github.skjolber.decorators.SyntaxHighlightingDecorator">
				<syntaxHighlighterFactory class="no.entur.logging.cloud.gcp.logback.logstash.test.LogSeveritySyntaxHighlighterFactory">
					<severity>
						<info>green</info>
						<warning>yellow</warning>
						<error>red</error>
						<critical>highIntensity red</critical>
						<alert>highIntensity red</alert>
						<emergency>highIntensity red</emergency>
					</severity>
					<message>highIntensity black</message>
				</syntaxHighlighterFactory>
			</jsonGeneratorDecorator>
		</humanReadableJsonEncoder>
		<machineReadableJsonEncoder class="no.entur.logging.cloud.gcp.logback.logstash.StackdriverLogstashEncoder">
			<!-- note: this encoder will be used to evaluate assertions against log statements -->
			<provider class="no.entur.logging.cloud.gcp.logback.logstash.StackdriverServiceContextJsonProvider"/>
		</machineReadableJsonEncoder>
	</appender>

</configuration>